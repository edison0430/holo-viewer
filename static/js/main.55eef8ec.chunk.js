(this["webpackJsonpholo-viewer"]=this["webpackJsonpholo-viewer"]||[]).push([[0],{37:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(10),s=n.n(c),i=n(5),l=n(7),o=n(24),d=(n(37),n(3)),u=n.n(d),j=n(11),b=n.n(j),f=(n(38),n(12)),m=n(25),h=n.n(m),x=n(1);function O(e){var t=u()();return u.a.duration(t.diff(u()(e))).format("HH:mm:ss")}u.a.extend(b.a),u.a.extend(h.a);var v=function(e){var t=e.stream.start_at,n=Object(r.useState)((function(){return O(t)})),a=Object(f.a)(n,2),c=a[0],s=a[1];return Object(r.useEffect)((function(){var e=setInterval((function(){s(O(t))}),1e3);return function(){clearInterval(e)}}),[t]),Object(x.jsx)("span",{className:"absolute bottom-2 right-2 text-white font-bold tracking-wide bg-red-600/90 px-2 py-0 rounded-sm",children:c})};u.a.extend(b.a),u.a.locale("zh-tw");var p=function(e){var t,n=e.stream,r=Object(i.c)((function(e){return e.streamReducer.channel})),a=Object(i.c)((function(e){return e.streamReducer.member})),c=null===(t=r.find((function(e){return e.id===n.channel_id})))||void 0===t?void 0:t.member_id,s=a.find((function(e){return e.id===c}));return Object(x.jsx)("a",{href:"https://www.youtube.com/watch?v=".concat(n.room),target:"_blank",rel:"noreferrer noopener",children:Object(x.jsxs)("div",{className:"w-full shadow bg-white rounded-lg overflow-hidden",children:[Object(x.jsxs)("div",{className:"relative pt-[56.25%]",children:[Object(x.jsx)("img",{className:"absolute top-0 left-0 w-full h-full object-contain",src:n.cover,alt:n.title}),"live"===n.status&&Object(x.jsx)(v,{stream:n})]}),Object(x.jsxs)("div",{className:"flex items-center h-[80px]",children:[Object(x.jsx)("div",{className:"w-[50px] rounded-full overflow-hidden ml-2 mr-4",children:Object(x.jsx)("img",{src:null===s||void 0===s?void 0:s.avatar,alt:"avator"})}),Object(x.jsxs)("div",{className:"flex-1 min-w-0",children:[Object(x.jsx)("p",{className:"text-lg text-left tracking-wide text-i truncate",children:n.title}),Object(x.jsx)("p",{className:"pt-1",children:null===s||void 0===s?void 0:s.name}),"scheduled"===n.status&&function(){var e=u()(n.start_at).format("HH:mm"),t=u()(n.start_at).fromNow();return Object(x.jsxs)("p",{className:"text-sm",children:["\u5c07\u65bc ",t,"\u958b\u59cb (",e,")"]})}()]})]})]},n.id)})},g=n(6),w=n.n(g),N=n(2),y=n(9),S="FETCH_LIVE_STREAM",E="FETCH_SCHEDULED_STREAM",k="FETCH_CHANNEL",_="FETCH_MEMBER",C=n(26),H=n.n(C).a.create({baseURL:"https://holo.dev/api/v1"});var T=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.streamReducer.liveStream})),n=Object(i.c)((function(e){return e.streamReducer.scheduledStream}));Object(r.useEffect)((function(){e(function(){var e=Object(y.a)(w.a.mark((function e(t){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.get("/lives/current");case 2:n=e.sent,r=n.data.lives.map((function(e){return Object(N.a)(Object(N.a)({},e),{},{status:"live"})})),t({type:S,payload:r});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(y.a)(w.a.mark((function e(t){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.get("/lives/scheduled");case 2:n=e.sent,r=n.data.lives.map((function(e){return Object(N.a)(Object(N.a)({},e),{},{status:"scheduled"})})),t({type:E,payload:r});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(y.a)(w.a.mark((function e(t){var n,r,a,c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(n=JSON.parse(sessionStorage.getItem("channel"))||[]).length){e.next=13;break}r=1,a=!0;case 4:if(!a){e.next=12;break}return e.next=7,H.get("channels?limit=100&page=".concat(r));case 7:c=e.sent,(n=n.concat(c.data.channels)).length<c.data.total?r++:a=!1,e.next=4;break;case 12:sessionStorage.setItem("channel",JSON.stringify(n));case 13:t({type:k,payload:n});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(y.a)(w.a.mark((function e(t){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(n=JSON.parse(sessionStorage.getItem("member"))||[]).length){e.next=7;break}return e.next=4,H.get("/members");case 4:r=e.sent,n=r.data,sessionStorage.setItem("member",JSON.stringify(n));case 7:t({type:_,payload:n});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]);var a=t.map((function(e){return Object(x.jsx)(p,{stream:e},e.id)})),c=n.filter((function(e){return u()(e.start_at).isBefore(u()().add(1,"day"))})).map((function(e){return Object(x.jsx)(p,{stream:e},e.id)}));return Object(x.jsxs)("div",{children:[Object(x.jsxs)("div",{children:[Object(x.jsx)("p",{className:"text-lg font-bold text-green-600 mb-5",children:"\u76f4\u64ad\u4e2d"}),Object(x.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-2",children:0===t.length?"There is no live stream now":a})]}),Object(x.jsxs)("div",{className:"mt-6",children:[Object(x.jsx)("p",{className:"text-lg font-bold text-green-600 mb-5",children:"\u9810\u5b9a\u76f4\u64ad"}),Object(x.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-2",children:0===n.length?"There is no scheduled stream now":c})]})]})},R=n(8);var F=function(e){var t=e.open,n=e.toggle,a=Object(r.useRef)(null);return Object(r.useEffect)((function(){var e=function(e){if(!a.current.contains(e.target)){if(!t)return;n()}};return window.addEventListener("click",e),function(){return window.removeEventListener("click",e)}}),[t]),Object(x.jsxs)("aside",{ref:a,className:"fixed top-0 left-0 h-screen w-56 ".concat(!t&&"-translate-x-full"," bg-white z-10 transform duration-200"),children:[Object(x.jsxs)("div",{className:"h-14 pl-4 mb-2 flex items-center space-x-4",children:[Object(x.jsx)("button",{onClick:n,className:"w-6 h-6",children:Object(x.jsx)(R.b,{})}),Object(x.jsx)("div",{className:"text-xl tracking-wide font-bold",children:"Holo Viewer"})]}),Object(x.jsx)("nav",{children:Object(x.jsxs)("a",{href:"",className:"py-2 px-4 flex items-center space-x-4 hover:bg-gray-100 ",children:[Object(x.jsx)(R.a,{className:"h-6 w-6"}),Object(x.jsx)("span",{children:"\u9996\u9801"})]})})]})};var I=function(){var e=Object(r.useState)(!1),t=Object(f.a)(e,2),n=t[0],a=t[1],c=function(){a((function(e){return!e}))};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("header",{className:"h-14 w-full flex items-center bg-gray-400/90 sticky top-0 z-10 backdrop-blur-sm pl-4 space-x-4",children:[Object(x.jsx)("button",{onClick:c,className:"w-6 h-6",children:Object(x.jsx)(R.b,{})}),Object(x.jsx)("div",{className:"text-xl tracking-wide font-bold",children:"Holo Viewer"})]}),Object(x.jsx)(F,{open:n,toggle:c})]})};var L=function(e){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(I,{}),Object(x.jsx)("main",{children:e.children})]})};var J=function(){return Object(x.jsx)(L,{children:Object(x.jsx)("div",{className:"p-4 min-h-screen bg-gray-100",children:Object(x.jsx)(T,{})})})},M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,60)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))},D={liveStream:[],scheduledStream:[],channel:[],member:[]},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return Object(N.a)(Object(N.a)({},e),{},{liveStream:t.payload});case E:return Object(N.a)(Object(N.a)({},e),{},{scheduledStream:t.payload});case k:return Object(N.a)(Object(N.a)({},e),{},{channel:t.payload});case _:return Object(N.a)(Object(N.a)({},e),{},{member:t.payload});default:return e}},V=Object(l.b)({streamReducer:B}),z=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.c,A=Object(l.d)(V,z(Object(l.a)(o.a)));s.a.render(Object(x.jsx)(i.a,{store:A,children:Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(J,{})})}),document.getElementById("root")),M()}},[[59,1,2]]]);
//# sourceMappingURL=main.55eef8ec.chunk.js.map